# mcd-molcas

Copyright (C) Jochen Autschbach, 2018-2025

Tools for calculating magnetic circular dichroism (MCD),
magneto-chiral dichroism (MChD), and natural electronic circular
dichroism (CD) and absorption spectra using data files generated by
the RASSI program of the [OpenMolcas](https://github.com/Molcas/OpenMolcas) quantum chemistry package. Other
tools have been added over time, such as a code for the van Vleck
magnetic susceptibility.

The code in this repository has been used previously for the following
publications (and a few others):

Curran, D. J.; Ganguly, G.; Heit, Y. N.; Wolford, N. J.; Minasian,
S. G.; Löble, M. W.; Cary, S. K.; Kozimor, S. A.; Autschbach, J.;
Neidig, M. L., ‘Near-Infrared C-term MCD Spectroscopy of Octahedral
Uranium(V) Complexes’, Dalton Trans. 2021, 50, 4853–4925. URL
https://doi.org/10.1039/D1DT00513H

Atzori, M.; Ludowieg, H.; Cortijo, M.; Breslavetz, I.; Paillot, K.;
Rosa, P.; Train, C.; Autschbach, J.; Hillard, E. A.; Rikken,
G. L. J. A., ‘Validation of Microscopic Magneto-Chiral Dichroism
Theory’, Science Advances 2021, 7, eabg2859 (7 pages). URL
https://doi.org/10.1126/sciadv.abg2859

Fleischauer, V. E.; Ganguly, G.; Woen, D. H.; Wolford, N. J.; Evans,
W. J.; Autschbach, J.; Neidig, M. L., ‘Insight into the Electronic
Structure of Formal Lanthanide(II) Complexes using Magnetic Circular
Dichroism Spectroscopy’, Organometallics 2019, 38, 3124–3131. URL
https://doi.org/10.1021/acs.organomet.9b00315

Heit, Y. N.; Sergentu, D.-C.; Autschbach, J., ‘Magnetic circular
dichroism spectra of transition metal complexes calculated from
restricted active space wavefunctions’, Phys. Chem. Chem. Phys. 2019,
21, 5586–5597. URL https://doi.org/10.1039/C8CP07849A

Gendron, F.; Fleischauer, V. E.; Duignan, T. J.; Scott, B. L.; Löble,
M. W.; Cary, S. K.; Kozimor, S.; Bolvin, H.; Neidig, M. L.;
Autschbach, J., ‘Magnetic circular dichroism of UCl6− in the
ligand-to-metal charge-transfer spectral region’,
Phys. Chem. Chem. Phys. 2017, 19, 17300–17313.  URL
https://doi.org/10.1039/C7CP02572F

OpenMolcas is available from https://github.com/Molcas/OpenMolcas

Usage:

Run OpenMolcas with the following keywords in the SEWARD step

    Angmom
    0.0 0.0 0.0
    AMFI

and with the following keywords in the RASSI step of the calculation:

    MEES
    MESO
    SPIN
    PRPRint
    PROPerties
    7
    'AngMom' 1
    'AngMom' 2
    'AngMom' 3
    'Mltpl  0' 1
    'MltPl  1' 1
    'MltPl  1' 2
    'MltPl  1' 3

Use of the `PRPRint` keyword will cause operator matrix elements in
the basis of all RASSI spin-orbit coupled wavefunctions to be written
to ASCII text files named `spin-1.txt`, `spin-2.txt`, `spin-3.txt`,
`angmon-1.txt` etc., `dipole-1.txt` etc., for the x, y, and z
components (1,2,3). The relevant operators are those for the electron
spin, the electron orbital angular momentum, and the electron dipole
moment, respectively.

Run the script `molcas-get-energies.sh` provided in this repository
with the RASSI output file name as the argument to create a list of
state energies in file `energies.txt`:

    molcas-get-energies.sh <rassi output file>

The programs being provided in this repository read Fortran `namelist`
input from a file `options.dat` along with the wavefunction data and
state energies provided in the files mentioned above. The states are
grouped into degenerate levels, where applicable, based on a threshold
set by the namelist input. Some of the options that can be set in
`options.dat` are as follows:

    nstates (integer) : number of states, must match energies.txt
    degen (integer)   : ground state degeneracy. Set to 0 for autodetection
    ddelta (real)     : criterion for state degeneracy (Hartree)
    temp (real)       : temperature (K) for MCD/MChD C-term calculations
    trange(1:2) (real): start/end temp. for susceptibility
    oldspiny (logical): use Molcas spin-y convention pre-2020 (see code)

`nstates` *must* be provided, almost everything else is optional. The
`temp` variable must be defined and set to a value > 0 for the
MCD/MChD C-term codes to run without errors.  The default value for
`ddelta` is 1E-5. States that have energies differing by no more than
`ddelta` are grouped into degenerate levels. The `temp`
setting is ignored by the susceptibility code. The `trange` setting is
ignored by the MCD/MChD C-term codes. The `trange` default is 1 to 301
K. The programs try to detect if unphysical values are given for the
most important options. However, proceed at your own risk.

Additional options are available for some of the functionality. Please
see the relevant source code files and example calculations for
explanations. Each of the executable programs goes through the same
initial steps to parse the namelist options and read the data
files. Some of the functionality requires also electric quadrupole
matrix elements, or the electric dipole and quadrupole data in
velocity form. See the example job `ethene-twisted` how to set this
up.